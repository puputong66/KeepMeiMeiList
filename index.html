<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¦¹å¦¹ä¿æ¯ä»»å‹™ç”Ÿæˆå™¨</title>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <style>
        /* CSS æ¨£å¼å€åŸŸ */
        :root {
            --sidebar-width: 250px;
            --light-bg: #f4f7f6;
            --card-bg: #ffffff;
            --primary-color: #3f51b5;
            --secondary-color: #4caf50;
            --text-color: #333;
            --border-color: #e0e0e0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: var(--light-bg);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
        }

        h1 {
            color: var(--primary-color);
            text-align: center;
            padding: 10px 0;
            font-size: 1.5em;
            margin: 0;
        }

        /* ----------------------- éŸ¿æ‡‰å¼ä½ˆå±€ (RWD) ----------------------- */
        .container {
            display: flex;
            width: 100%;
            flex-grow: 1;
        }

        /* å´é‚Šæ¬„ - ä»»å‹™å¡ç‰‡å€ */
        .sidebar {
            width: var(--sidebar-width);
            background-color: #e0f2f1; /* æ·ºç¶ è‰²ç³»èƒŒæ™¯ */
            padding: 20px 10px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        /* ä¸»è¦å…§å®¹å€ - To Do List å€ */
        .main-content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }

        /* æ‰‹æ©Ÿæ¨¡å¼ (å°æ–¼ 768px) */
        @media (max-width: 768px) {
            .container {
                flex-direction: column; /* å‚ç›´å †ç–Š */
            }
            .sidebar {
                width: 100%;
                height: auto;
                max-height: 30vh; /* æ‰‹æ©Ÿä¸Šä»»å‹™å¡ç‰‡å€é«˜åº¦é™åˆ¶ */
                overflow-x: hidden;
                padding: 10px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
            .task-cards-grid {
                display: flex;
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            .task-card {
                flex: 0 0 120px; /* å¡ç‰‡å›ºå®šå¯¬åº¦ */
                margin: 5px;
                font-size: 0.9em;
            }
            .main-content {
                padding: 10px;
                min-height: 70vh;
            }
        }

        /* ----------------------- ä»»å‹™å¡ç‰‡æ¨£å¼ ----------------------- */
        .task-cards-grid {
            display: grid;
            gap: 10px;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        }

        .task-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            font-weight: bold;
            user-select: none; /* é˜²æ­¢æ–‡å­—è¢«é¸ä¸­ */
        }

        .task-card:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        /* æ‹–æ›³æ™‚çš„è¦–è¦ºæ•ˆæœ */
        .sortable-ghost {
            opacity: 0.4;
            background-color: #c8e6c9;
            border: 2px dashed var(--secondary-color);
        }
        
        /* ----------------------- To Do List å€åŸŸæ¨£å¼ ----------------------- */
        .todo-section {
            background-color: var(--card-bg);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-left: 5px solid var(--primary-color);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--primary-color);
        }

        input[type="date"], input[type="text"], select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 1em;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* To Do List æ‹–æ›³å€ */
        .task-list {
            min-height: 120px;
            border: 2px dashed var(--border-color);
            padding: 10px;
            border-radius: 8px;
            background-color: #fcfcfc;
        }

        .list-item {
            background-color: #e3f2fd; /* æ·ºè—è‰² */
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
            border: 1px solid #bbdefb;
            font-weight: 500;
        }

        .list-item-content {
            flex-grow: 1;
        }

        .remove-btn {
            background: none;
            border: none;
            color: #ef5350; /* ç´…è‰² */
            cursor: pointer;
            font-size: 1.2em;
            margin-left: 10px;
        }
        
        /* ----------------------- æŒ‰éˆ•æ¨£å¼ ----------------------- */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap; /* RWD æ›è¡Œ */
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s, transform 0.1s;
            flex-grow: 1;
            min-width: 120px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #303f9f;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover {
            background-color: #388e3c;
        }

        .btn-danger {
            background-color: #ff6e6e;
            color: white;
        }

        .btn-danger:hover {
            background-color: #e53935;
        }

        .btn:active {
            transform: scale(0.98);
        }

        /* ----------------------- å½ˆå‡ºè¦–çª— (Modal) æ¨£å¼ ----------------------- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            backdrop-filter: blur(3px);
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
        
        /* ----------------------- è¤‡è£½çµæœå€å¡Šæ¨£å¼ ----------------------- */
        #copy-output {
            white-space: pre-wrap;
            text-align: left;
            padding: 15px;
            border: 1px solid var(--border-color);
            background-color: var(--light-bg);
            margin-bottom: 15px;
            border-radius: 5px;
        }
        
        /* éš±è—å€å¡Šï¼Œç”¨æ–¼æˆªåœ–åŠŸèƒ½ */
        .hidden-for-layout {
            display: none;
        }

        .screenshot-area {
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="sidebar">
            <h1>ä»»å‹™å¡ç‰‡</h1>
            <div id="task-cards-source" class="task-cards-grid">
                <div class="task-card" data-task="é¤µç½ç½">é¤µç½ç½</div>
                <div class="task-card" data-task="éŸå±">éŸå±</div>
                <div class="task-card" data-task="æ”¶ï¼‹æ´—ç½ç½ç¢—">æ”¶ï¼‹æ´—ç½ç½ç¢—</div>
                <div class="task-card" data-task="æ›é£¼æ–™ç›¤ï¼Œæ–°çš„æ“¦ä¹¾åŠ 30gé£¼æ–™">æ›é£¼æ–™ç›¤ï¼Œæ–°çš„æ“¦ä¹¾åŠ 30gé£¼æ–™</div>
                <div class="task-card" data-task="æ›æ°´ç¢—ï¼ˆå…±å››å€‹ï¼‰">æ›æ°´ç¢—ï¼ˆå…±å››å€‹ï¼‰</div>
                <div class="task-card" data-task="å»šæˆ¿ç‡ˆä¸ç”¨é—œ">å»šæˆ¿ç‡ˆä¸ç”¨é—œ</div>
                <div class="task-card" data-task="è·Ÿå¦¹å¦¹èªªå—¨">è·Ÿå¦¹å¦¹èªªå—¨</div>
                <div class="task-card" data-task="æ‘¸æ‘¸å¦¹å¦¹">æ‘¸æ‘¸å¦¹å¦¹</div>
                <div class="task-card" data-task="çœ‹å¦¹å¦¹è¦ä¸è¦æ¢³æ¯›">çœ‹å¦¹å¦¹è¦ä¸è¦æ¢³æ¯›</div>
                <div class="task-card" data-task="å…¶ä»–(è‡ªè¡Œå¡«å…¥)">å…¶ä»–(è‡ªè¡Œå¡«å…¥)</div>
            </div>
        </div>

        <div class="main-content" id="main-content">
            <h1>å¦¹å¦¹ä¿æ¯ä»»å‹™ To Do List</h1>
            
            <div id="task-sections-container">
                </div>

            <div class="button-group">
                <button id="reset-all-btn" class="btn btn-danger">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰å…§å®¹</button>
            </div>
        </div>
    </div>

    <div id="result-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>ä»»å‹™å®Œæˆï¼è«‹é¸æ“‡æ“ä½œ</h2>
            <div class="button-group" style="margin-top: 0;">
                <button id="copy-text-btn" class="btn btn-primary">ğŸ“‹ ç´”æ–‡å­—è¤‡è£½</button>
                <button id="screenshot-btn" class="btn btn-secondary">ğŸ–¼ï¸ æˆªåœ– (å³éµå­˜æª”)</button>
            </div>
            
            <div id="copy-output-area" class="hidden-for-layout">
                <h3 style="color: var(--primary-color);">è¤‡è£½å…§å®¹é è¦½ï¼š</h3>
                <pre id="copy-output"></pre>
            </div>
            
            <div id="screenshot-display-area"></div>
        </div>
    </div>

    <script>
        // JavaScript é‚è¼¯å€åŸŸ
        document.addEventListener('DOMContentLoaded', () => {
            const sectionsContainer = document.getElementById('task-sections-container');
            const resultModal = document.getElementById('result-modal');
            const closeBtn = document.querySelector('.close-btn');
            const copyTextBtn = document.getElementById('copy-text-btn');
            const screenshotBtn = document.getElementById('screenshot-btn');
            const copyOutput = document.getElementById('copy-output');
            const screenshotDisplayArea = document.getElementById('screenshot-display-area');
            const resetAllBtn = document.getElementById('reset-all-btn');

            let sectionCount = 0;

            // ----------------------------------------
            // 1. æ ¸å¿ƒå‡½æ•¸ï¼šç”Ÿæˆä»»å‹™å€å¡Š HTML
            // ----------------------------------------
            function createTaskSection() {
                sectionCount++;
                const sectionId = `section-${sectionCount}`;
                const sectionHtml = `
                    <div id="${sectionId}" class="todo-section">
                        <h2>ä»»å‹™æ™‚æ®µ #${sectionCount}</h2>
                        
                        ${sectionCount === 1 ? `
                        <div class="form-group">
                            <label for="date-picker">æ—¥æœŸé¸æ“‡å™¨</label>
                            <input type="date" id="date-picker" value="${new Date().toISOString().slice(0, 10)}">
                        </div>
                        ` : ''}

                        <div class="form-group">
                            <label for="${sectionId}-time-slot">æ™‚æ®µé¸æ“‡å™¨</label>
                            <select id="${sectionId}-time-slot">
                                <option value="æ—©ä¸Š (ç´„ 8:00 - 10:00)">æ—©ä¸Š (ç´„ 8:00 - 10:00)</option>
                                <option value="ä¸­åˆ (ç´„ 11:00 - 13:00)">ä¸­åˆ (ç´„ 11:00 - 13:00)</option>
                                <option value="ä¸‹åˆ (ç´„ 14:00 - 17:00)">ä¸‹åˆ (ç´„ 14:00 - 17:00)</option>
                                <option value="æ™šä¸Š (ç´„ 18:00 - 20:00)" selected>æ™šä¸Š (ç´„ 18:00 - 20:00)</option>
                                <option value="ç¡å‰ (ç´„ 21:00 - 23:00)">ç¡å‰ (ç´„ 21:00 - 23:00)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="${sectionId}-time-note">æ™‚é–“å‚™è¨»</label>
                            <input type="text" id="${sectionId}-time-note" placeholder="ä¾‹å¦‚ï¼š19:30 æº–æ™‚é¤µé£Ÿ">
                        </div>

                        <div class="form-group">
                            <label>ä»»å‹™ To Do List (æœ€å¤š 10 å€‹ï¼Œå¯æ‹–æ›³æ’åº)</label>
                            <div id="${sectionId}-task-list" class="task-list">
                                <p style="text-align:center; color:#999; margin: 25px 0;">è«‹å¾å·¦å´æ‹–æ›³ä»»å‹™å¡ç‰‡è‡³æ­¤</p>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="${sectionId}-task-note">ä»»å‹™å‚™è¨»</label>
                            <textarea id="${sectionId}-task-note" placeholder="ä¾‹å¦‚ï¼šå¦¹å¦¹ä»Šå¤©ç²¾ç¥å¾ˆå¥½ï¼Œç½ç½å…¨éƒ¨åƒå®Œ"></textarea>
                        </div>
                        
                        <div class="button-group">
                            <button class="btn btn-primary complete-task-btn" data-section-id="${sectionId}">âœ… ç¢ºå®š (çµæŸæ’ä»»å‹™)</button>
                            <button class="btn btn-secondary add-section-btn">â• å¢åŠ ä¸‹ä¸€å€‹æ™‚æ®µ</button>
                        </div>
                    </div>
                `;
                sectionsContainer.insertAdjacentHTML('beforeend', sectionHtml);

                // åˆå§‹åŒ– SortableJS
                const taskListEl = document.getElementById(`${sectionId}-task-list`);
                new Sortable(taskListEl, {
                    group: {
                        name: 'tasks',
                        pull: 'clone', // å…è¨±å¾é€™è£¡æ‹‰å‡ºå»
                        put: true // å…è¨±å¾å¤–é¢æ‹‰é€²ä¾†
                    },
                    animation: 150,
                    sort: true, // å…è¨±å…§éƒ¨æ’åº
                    onAdd: function (evt) {
                        handleTaskDrop(evt, taskListEl);
                    },
                    filter: '.list-item .remove-btn', // å…è¨±é»æ“Šåˆªé™¤æŒ‰éˆ•
                    onFilter: function (evt) {
                        evt.item.parentNode.removeChild(evt.item);
                        checkEmptyState(taskListEl);
                    }
                });

                // ç‚ºæ–°æŒ‰éˆ•ç¶å®šäº‹ä»¶
                document.querySelector(`#${sectionId} .add-section-btn`).addEventListener('click', createTaskSection);
                document.querySelector(`#${sectionId} .complete-task-btn`).addEventListener('click', (e) => showResultModal(e.target.dataset.sectionId));
            }

            // ----------------------------------------
            // 2. æ‹–æ›³è™•ç†ï¼šè™•ç†ä»»å‹™å¡ç‰‡æ‹‰å…¥
            // ----------------------------------------
            function handleTaskDrop(evt, taskListEl) {
                const item = evt.item;
                const taskName = item.dataset.task;

                // ç§»é™¤ä½”ä½æç¤º
                checkEmptyState(taskListEl, true);

                // æª¢æŸ¥æ˜¯å¦è¶…é 10 å€‹ä»»å‹™
                if (taskListEl.children.length > 10) {
                    item.parentNode.removeChild(item);
                    alert("ä¸€å€‹æ™‚æ®µæœ€å¤šåªèƒ½æ’ 10 å€‹ä»»å‹™å–”ï¼");
                    return;
                }

                // è™•ç†ã€Œå…¶ä»–(è‡ªè¡Œå¡«å…¥)ã€
                if (taskName === 'å…¶ä»–(è‡ªè¡Œå¡«å…¥)') {
                    const customText = prompt("è«‹è¼¸å…¥è‡ªå®šç¾©ä»»å‹™å…§å®¹ (ä¾‹å¦‚ï¼šæ›è²“ç ‚)");
                    if (customText) {
                        item.innerHTML = `<span class="list-item-content">${customText}</span> <button class="remove-btn">&times;</button>`;
                        item.dataset.taskContent = customText; // å„²å­˜çœŸå¯¦å…§å®¹
                        item.classList.add('list-item');
                        item.classList.remove('task-card');
                    } else {
                        // å¦‚æœå–æ¶ˆè¼¸å…¥ï¼Œå‰‡ç§»é™¤è©²é …ç›®
                        item.parentNode.removeChild(item);
                    }
                } else {
                    // è™•ç†ä¸€èˆ¬ä»»å‹™
                    item.innerHTML = `<span class="list-item-content">${taskName}</span> <button class="remove-btn">&times;</button>`;
                    item.dataset.taskContent = taskName; // å„²å­˜çœŸå¯¦å…§å®¹
                    item.classList.add('list-item');
                    item.classList.remove('task-card');
                }
            }

            // ----------------------------------------
            // 3. ä½”ä½ç¬¦æª¢æŸ¥
            // ----------------------------------------
            function checkEmptyState(taskListEl, removing = false) {
                const items = taskListEl.querySelectorAll('.list-item').length;
                let placeholder = taskListEl.querySelector('p');

                if (items === 0 && !placeholder) {
                    taskListEl.innerHTML = '<p style="text-align:center; color:#999; margin: 25px 0;">è«‹å¾å·¦å´æ‹–æ›³ä»»å‹™å¡ç‰‡è‡³æ­¤</p>';
                } else if (items > 0 && placeholder && removing) {
                    placeholder.remove();
                }
            }


            // ----------------------------------------
            // 4. æ¨¡æ…‹è¦–çª—èˆ‡æ•¸æ“šç²å–
            // ----------------------------------------
            let activeSectionId = null;

            function showResultModal(sectionId) {
                activeSectionId = sectionId;
                const modalTitle = document.querySelector('#result-modal h2');
                modalTitle.textContent = `ä»»å‹™æ™‚æ®µ #${sectionId.split('-')[1]} å®Œæˆï¼è«‹é¸æ“‡æ“ä½œ`;
                
                // é å…ˆç”Ÿæˆç´”æ–‡å­—å…§å®¹
                generateTextOutput();
                
                // æ¸…ç©ºæˆªåœ–å€åŸŸ
                screenshotDisplayArea.innerHTML = '';
                
                resultModal.style.display = 'block';
            }

            closeBtn.onclick = () => {
                resultModal.style.display = 'none';
            }

            window.onclick = (event) => {
                if (event.target == resultModal) {
                    resultModal.style.display = 'none';
                }
            }

            function generateTextOutput() {
                const date = document.getElementById('date-picker').value;
                
                let output = `ğŸ“… ä»»å‹™æ—¥æœŸï¼š${date}\n\n`;
                
                // ç²å–æ‰€æœ‰ä»»å‹™å€å¡Šçš„æ•¸æ“š
                document.querySelectorAll('.todo-section').forEach((section, index) => {
                    const sectionId = section.id;
                    const timeSlot = document.getElementById(`${sectionId}-time-slot`).value;
                    const timeNote = document.getElementById(`${sectionId}-time-note`).value;
                    const taskNote = document.getElementById(`${sectionId}-task-note`).value;
                    const taskListEl = document.getElementById(`${sectionId}-task-list`);
                    
                    output += `----------------------------------------\n`;
                    output += `ğŸ•’ æ™‚æ®µ ${index + 1}ï¼š${timeSlot}\n`;
                    if (timeNote) {
                        output += `ğŸ•’ æ™‚é–“å‚™è¨»ï¼š${timeNote}\n`;
                    }
                    output += `\n`;
                    
                    // ä»»å‹™åˆ—è¡¨
                    output += `ğŸ“ ä»»å‹™ To Do Listï¼š\n`;
                    taskListEl.querySelectorAll('.list-item').forEach((item, i) => {
                        const content = item.dataset.taskContent || item.querySelector('.list-item-content').textContent.trim();
                        output += `   [${i + 1}] ${content}\n`;
                    });

                    if (taskNote) {
                        output += `\nâœï¸ ä»»å‹™å‚™è¨»ï¼š${taskNote}\n`;
                    }
                });

                copyOutput.textContent = output;
                return output;
            }

            // ----------------------------------------
            // 5. æŒ‰éˆ•åŠŸèƒ½ï¼šè¤‡è£½èˆ‡æˆªåœ–
            // ----------------------------------------
            copyTextBtn.onclick = () => {
                const textToCopy = generateTextOutput();
                navigator.clipboard.writeText(textToCopy).then(() => {
                    alert('ç´”æ–‡å­—ä»»å‹™æ¸…å–®å·²æˆåŠŸè¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
                }).catch(err => {
                    console.error('è¤‡è£½å¤±æ•—: ', err);
                    alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½ä¸‹æ–¹æ–‡å­—ã€‚');
                });
            };

            screenshotBtn.onclick = () => {
                screenshotDisplayArea.innerHTML = 'æ­£åœ¨ç”Ÿæˆåœ–ç‰‡ï¼Œè«‹ç¨å€™...';
                
                // 1. éš±è—ä¸å¿…è¦çš„å…ƒç´  (æŒ‰éˆ•å€ã€Modal å…§å®¹è‡ªèº«)
                const buttonsToHide = document.querySelectorAll('.button-group');
                buttonsToHide.forEach(btn => btn.style.display = 'none');
                
                // 2. å‰µå»ºä¸€å€‹å°ˆé–€ç”¨æ–¼æˆªåœ–çš„ DIVï¼ŒåŒ…å«æ‰€æœ‰ä»»å‹™å€å¡Š
                const screenshotArea = document.createElement('div');
                screenshotArea.className = 'screenshot-area';
                
                const allSectionsHTML = Array.from(document.querySelectorAll('.todo-section')).map(section => {
                    // è¤‡è£½æ¯å€‹ section çš„å…§å®¹ï¼Œä¸¦éš±è—å…¶å…§éƒ¨çš„åˆªé™¤æŒ‰éˆ•
                    const tempSection = section.cloneNode(true);
                    tempSection.querySelectorAll('.remove-btn').forEach(btn => btn.remove());
                    tempSection.querySelector('.button-group').remove();
                    return tempSection.outerHTML;
                }).join('');

                const date = document.getElementById('date-picker').value;
                screenshotArea.innerHTML = `
                    <h1 style="margin-bottom: 15px;">å¦¹å¦¹ä¿æ¯ä»»å‹™æ¸…å–®</h1>
                    <h3 style="color: var(--secondary-color);">ğŸ—“ï¸ ä»»å‹™æ—¥æœŸï¼š${date}</h3>
                    ${allSectionsHTML}
                `;

                // æš«æ™‚å°‡æˆªåœ–å€åŸŸæ·»åŠ åˆ° bodyï¼Œä»¥ä¾¿ html2canvas è™•ç†
                document.body.appendChild(screenshotArea);
                
                // 3. åŸ·è¡Œæˆªåœ–
                html2canvas(screenshotArea, { 
                    scale: 2, // æé«˜è§£æåº¦
                    logging: false 
                }).then(canvas => {
                    // 4. æ¸…ç†ä¸¦é¡¯ç¤ºçµæœ
                    screenshotDisplayArea.innerHTML = '';
                    canvas.style.maxWidth = '100%'; // RWD èª¿æ•´
                    canvas.style.borderRadius = '8px';
                    canvas.style.boxShadow = '0 0 10px rgba(0,0,0,0.2)';
                    screenshotDisplayArea.appendChild(canvas);

                    // é‡æ–°é¡¯ç¤ºè¢«éš±è—çš„æŒ‰éˆ•
                    buttonsToHide.forEach(btn => btn.style.display = 'flex');
                    
                    // ç§»é™¤æš«æ™‚çš„æˆªåœ–å€åŸŸ
                    document.body.removeChild(screenshotArea);
                    
                    alert('æˆªåœ–å·²ç”Ÿæˆï¼åœ¨åœ–ç‰‡ä¸Šé»æ“Šå³éµæˆ–é•·æŒ‰å³å¯å„²å­˜ã€‚');
                });
            };

            // ----------------------------------------
            // 6. åˆå§‹åŒ–èˆ‡æ¸…ç©º
            // ----------------------------------------
            // åˆå§‹åŒ–å´é‚Šæ¬„å¡ç‰‡çš„ Sortable
            new Sortable(document.getElementById('task-cards-source'), {
                group: {
                    name: 'tasks',
                    pull: 'clone', // å…è¨±å¾é€™è£¡æ‹‰å‡ºå»
                    put: false // ä¸å…è¨±å¾å¤–é¢æ‹‰é€²ä¾†
                },
                sort: false, // ä¸å…è¨±å…§éƒ¨æ’åº
                animation: 150
            });

            // æ¸…ç©ºæ‰€æœ‰å…§å®¹
            resetAllBtn.onclick = () => {
                if (confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰å·²æ’çš„ä»»å‹™å…§å®¹å—ï¼Ÿ')) {
                    sectionsContainer.innerHTML = ''; // ç§»é™¤æ‰€æœ‰å€å¡Š
                    sectionCount = 0; // é‡ç½®è¨ˆæ•¸å™¨
                    createTaskSection(); // é‡æ–°å‰µå»ºç¬¬ä¸€å€‹å€å¡Š
                    document.getElementById('date-picker').value = new Date().toISOString().slice(0, 10); // é‡è¨­æ—¥æœŸ
                }
            };

            // ç¶²é åŠ è¼‰å®Œæˆå¾Œï¼Œå‰µå»ºç¬¬ä¸€å€‹ä»»å‹™å€å¡Š
            createTaskSection();
        });
    </script>

</body>
</html>